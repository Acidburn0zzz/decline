<html><head><title>decline: Arguments</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="com.monovore" /><meta name="description" content="Composable command-line parsing for Scala" /><meta name="og:image" content="/decline/img/poster.png" /><meta name="og:title" content="decline: Arguments" /><meta name="og:site_name" content="decline" /><meta name="og:url" content="http://monovore.com/decline" /><meta name="og:type" content="website" /><meta name="og:description" content="Composable command-line parsing for Scala" /><link rel="icon" type="image/png" href="/decline/img/favicon.png" /><meta name="twitter:title" content="decline: Arguments" /><meta name="twitter:image" content="http://monovore.com/declineimg/poster.png" /><meta name="twitter:description" content="Composable command-line parsing for Scala" /><meta name="twitter:card" content="summary_large_image" /><link rel="icon" type="image/png" sizes="16x16" href="/decline/img/favicon16x16.png" /><link rel="icon" type="image/png" sizes="24x24" href="/decline/img/favicon24x24.png" /><link rel="icon" type="image/png" sizes="32x32" href="/decline/img/favicon32x32.png" /><link rel="icon" type="image/png" sizes="48x48" href="/decline/img/favicon48x48.png" /><link rel="icon" type="image/png" sizes="57x57" href="/decline/img/favicon57x57.png" /><link rel="icon" type="image/png" sizes="60x60" href="/decline/img/favicon60x60.png" /><link rel="icon" type="image/png" sizes="64x64" href="/decline/img/favicon64x64.png" /><link rel="icon" type="image/png" sizes="70x70" href="/decline/img/favicon70x70.png" /><link rel="icon" type="image/png" sizes="72x72" href="/decline/img/favicon72x72.png" /><link rel="icon" type="image/png" sizes="76x76" href="/decline/img/favicon76x76.png" /><link rel="icon" type="image/png" sizes="96x96" href="/decline/img/favicon96x96.png" /><link rel="icon" type="image/png" sizes="114x114" href="/decline/img/favicon114x114.png" /><link rel="icon" type="image/png" sizes="120x120" href="/decline/img/favicon120x120.png" /><link rel="icon" type="image/png" sizes="128x128" href="/decline/img/favicon128x128.png" /><link rel="icon" type="image/png" sizes="144x144" href="/decline/img/favicon144x144.png" /><link rel="icon" type="image/png" sizes="150x150" href="/decline/img/favicon150x150.png" /><link rel="icon" type="image/png" sizes="152x152" href="/decline/img/favicon152x152.png" /><link rel="icon" type="image/png" sizes="196x196" href="/decline/img/favicon196x196.png" /><link rel="icon" type="image/png" sizes="310x310" href="/decline/img/favicon310x310.png" /><link rel="icon" type="image/png" sizes="310x150" href="/decline/img/favicon310x150.png" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/decline/highlight/styles/solarized-light.css" /><link rel="stylesheet" href="/decline/css/style.css" /><link rel="stylesheet" href="/decline/css/palette.css" /><link rel="stylesheet" href="/decline/css/codemirror.css" /></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><ul id="sidebar" class="sidebar-nav"><li class="sidebar-brand"><a href="/decline/" class="brand"><div class="brand-wrapper"><span>decline</span></div></a></li><li><a href="/decline/arguments.html" class=" active ">Arguments</a></li><li><a href="/decline/" class="">Home</a></li><li><a href="/decline/css/palette.css" class=""></a></li><li><a href="/decline/refined.html" class="">Refined Argument types</a></li><li><a href="/decline/scalajs.html" class="">Scala.js</a></li><li><a href="/decline/css/style.css" class=""></a></li><li><a href="/decline/usage.html" class="">Using Decline</a></li></ul></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li id="gh-eyes-item" class="hidden-xs"><a href="https://github.com/bkirwi/decline"><i class="fa fa-eye"></i><span>WATCH<span id="eyes" class="label label-default">--</span></span></a></li><li id="gh-stars-item" class="hidden-xs"><a href="https://github.com/bkirwi/decline"><i class="fa fa-star-o"></i><span>STARS<span id="stars" class="label label-default">--</span></span></a></li><li><a href="#" onclick="shareSiteTwitter('decline Composable command-line parsing for Scala');"><i class="fa fa-twitter"></i></a></li><li><a href="#" onclick="shareSiteFacebook('decline Composable command-line parsing for Scala');"><i class="fa fa-facebook"></i></a></li><li><a href="#" onclick="shareSiteGoogle();"><i class="fa fa-google-plus"></i></a></li></ul></div></div></div></div><div id="content" data-github-owner="bkirwi" data-github-repo="decline"><div class="content-wrapper"><section><h1 id="argument-types"><code class="highlighter-rouge">Argument</code> Types</h1>

<p>In the <a href="/usage.html">guide</a>, we specified the type of an option’s argument like so:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">import</span> <span class="nn">com.monovore.decline._</span>
<span class="c1">// import com.monovore.decline._
</span>
<span class="k">import</span> <span class="nn">java.nio.file.Path</span>
<span class="c1">// import java.nio.file.Path
</span>
<span class="k">val</span> <span class="n">path</span> <span class="k">=</span> <span class="nc">Opts</span><span class="o">.</span><span class="n">option</span><span class="o">[</span><span class="kt">Path</span><span class="o">](</span><span class="s">"input"</span><span class="o">,</span> <span class="s">"Path to the input file."</span><span class="o">)</span>
<span class="c1">// path: com.monovore.decline.Opts[java.nio.file.Path] = Opts(--input &lt;path&gt;)
</span></code></pre>
</div>

<p>This does two different things for us:</p>

<ul>
  <li>It specifies a <em>parsing function</em> – when the user passes a string as an argument, <code class="highlighter-rouge">decline</code> will try and
interpret it as a path and report an error if it can’t.</li>
  <li>It specifies a default ‘metavar’ – the <code class="highlighter-rouge">&lt;path&gt;</code> text you can see in the output above. This helps the user
understand what sort of input your program expects in that position.</li>
</ul>

<p>This information is provided by the <code class="highlighter-rouge">com.monovore.decline.Argument</code> <a href="https://typelevel.org/cats/typeclasses.html">type class</a>.
<code class="highlighter-rouge">decline</code> provides instances for many commonly used standard-library types: strings, numbers, paths, URIs, and so on.</p>

<h2 id="defining-your-own">Defining Your Own</h2>

<p>In some cases, you’ll want to take a command-line argument that doesn’t quite map to a standard primitive type.
Say you have the following key-value config type:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">case</span> <span class="k">class</span> <span class="nc">Config</span><span class="o">(</span><span class="n">key</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">value</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span>
<span class="c1">// defined class Config
</span></code></pre>
</div>

<p>It’s easy enough to define an option that collects a list of configs, by specifying a
custom metavar and adding additional validation and parsing logic:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">import</span> <span class="nn">cats.data.Validated</span>
<span class="c1">// import cats.data.Validated
</span>
<span class="k">val</span> <span class="n">config</span> <span class="k">=</span> <span class="o">{</span>
  <span class="nc">Opts</span><span class="o">.</span><span class="n">option</span><span class="o">[</span><span class="kt">String</span><span class="o">](</span><span class="s">"config"</span><span class="o">,</span> <span class="s">"Specify an additional config."</span><span class="o">,</span> <span class="n">metavar</span> <span class="k">=</span> <span class="s">"key:value"</span><span class="o">)</span>
    <span class="o">.</span><span class="n">mapValidated</span> <span class="o">{</span> <span class="n">string</span> <span class="k">=&gt;</span>
      <span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="o">(</span><span class="s">":"</span><span class="o">,</span> <span class="mi">2</span><span class="o">)</span> <span class="k">match</span> <span class="o">{</span>
        <span class="k">case</span> <span class="nc">Array</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">value</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="nc">Validated</span><span class="o">.</span><span class="n">valid</span><span class="o">(</span><span class="nc">Config</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">value</span><span class="o">))</span>
        <span class="k">case</span> <span class="k">_</span> <span class="k">=&gt;</span> <span class="nc">Validated</span><span class="o">.</span><span class="n">invalidNel</span><span class="o">(</span><span class="n">s</span><span class="s">"Invalid key:value pair: $string"</span><span class="o">)</span>
      <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="c1">// config: com.monovore.decline.Opts[Config] = Opts(--config &lt;key:value&gt;)
</span></code></pre>
</div>

<p>For most cases, this works perfectly well! For larger applications, though –
where many different options, subcommands or programs might want to use this
same basic config type – doing this sort of thing each time is verbose and
error-prone.</p>

<p>It’s easy enough to bundle the metavar and parsing logic together in an <code class="highlighter-rouge">Argument</code> instance:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">implicit</span> <span class="k">val</span> <span class="n">configArgument</span><span class="k">:</span> <span class="kt">Argument</span><span class="o">[</span><span class="kt">Config</span><span class="o">]</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Argument</span><span class="o">[</span><span class="kt">Config</span><span class="o">]</span> <span class="o">{</span>

  <span class="k">def</span> <span class="n">read</span><span class="o">(</span><span class="n">string</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span> <span class="k">=</span> <span class="o">{</span>
    <span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="o">(</span><span class="s">":"</span><span class="o">,</span> <span class="mi">2</span><span class="o">)</span> <span class="k">match</span> <span class="o">{</span>
      <span class="k">case</span> <span class="nc">Array</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">value</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="nc">Validated</span><span class="o">.</span><span class="n">valid</span><span class="o">(</span><span class="nc">Config</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">value</span><span class="o">))</span>
      <span class="k">case</span> <span class="k">_</span> <span class="k">=&gt;</span> <span class="nc">Validated</span><span class="o">.</span><span class="n">invalidNel</span><span class="o">(</span><span class="n">s</span><span class="s">"Invalid key:value pair: $string"</span><span class="o">)</span>
    <span class="o">}</span>
  <span class="o">}</span>

  <span class="k">def</span> <span class="n">defaultMetavar</span> <span class="k">=</span> <span class="s">"key:value"</span>
<span class="o">}</span>
<span class="c1">// configArgument: com.monovore.decline.Argument[Config] = $anon$1@137ffebe
</span></code></pre>
</div>

<p>…and then defining new options that take configs becomes trivial:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">val</span> <span class="n">config</span> <span class="k">=</span> <span class="nc">Opts</span><span class="o">.</span><span class="n">option</span><span class="o">[</span><span class="kt">Config</span><span class="o">](</span><span class="s">"config"</span><span class="o">,</span> <span class="s">"Specify an additional config."</span><span class="o">)</span>
<span class="c1">// config: com.monovore.decline.Opts[Config] = Opts(--config &lt;key:value&gt;)
</span></code></pre>
</div>

<h2 id="missing-instances">Missing Instances</h2>

<p>In a few cases, <code class="highlighter-rouge">decline</code> has intentionally <em>not</em> defined an <code class="highlighter-rouge">Argument</code> instance for a particular type – since there
are better ways to achieve the same effect. Some examples:</p>

<ul>
  <li><code class="highlighter-rouge">Boolean</code>: supporting <code class="highlighter-rouge">Boolean</code> arguments like <code class="highlighter-rouge">Opts.option[Boolean]("verbose", ???)</code> would lead to command-line usage like 
<code class="highlighter-rouge">my-command --verbose true</code>… but users of other POSIX-ish command line tools would expect <code class="highlighter-rouge">my-command --verbose</code>.
You can get that more idiomatic style with <code class="highlighter-rouge">Opts.flag("verbose", ???).orFalse</code>; consider using that instead!</li>
  <li><code class="highlighter-rouge">java.io.File</code>, <code class="highlighter-rouge">java.net.URL</code>: these types are mostly superseded by better alternatives (<code class="highlighter-rouge">java.nio.file.Path</code> and
<code class="highlighter-rouge">java.net.URI</code>, respectively), and they support easy conversions to the older types to interoperate with existing code.</li>
  <li><code class="highlighter-rouge">List[A]</code>: you might expect to be able to define a <code class="highlighter-rouge">Opts.option[List[String]](...)</code> to parse a comma-separated list of
strings, like <code class="highlighter-rouge">--exclude foo,bar</code>. This ends up a little bit tricky in the general case: either you can’t parse strings
that contain commas, or you need some “escaping” mechanism, neither of which is particularly pleasant or idiomatic for
users. Instead, consider using the plural methods like <code class="highlighter-rouge">Opts.options</code> or <code class="highlighter-rouge">Opts.arguments</code> to accumulate a list,
like <code class="highlighter-rouge">--exclude foo --exclude bar</code>. (This is also easier to use programatically!)</li>
</ul>
</section></div></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/decline/highlight/highlight.pack.js"></script><script>hljs.configure({
languages:['scala','java','bash']
});
hljs.initHighlighting();
             </script><script>((window.gitter = {}).chat = {}).options = {
room: 'bkirwi/decline'};</script><script src="https://sidecar.gitter.im/dist/sidecar.v1.js"></script><script src="/decline/js/main.js"></script></body></html>