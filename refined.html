<html><head><title>decline: Refined Argument types</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="com.monovore" /><meta name="description" content="Composable command-line parsing for Scala" /><meta name="og:image" content="/decline/img/poster.png" /><meta name="og:title" content="decline: Refined Argument types" /><meta name="og:site_name" content="decline" /><meta name="og:url" content="http://monovore.com/decline" /><meta name="og:type" content="website" /><meta name="og:description" content="Composable command-line parsing for Scala" /><link rel="icon" type="image/png" href="/decline/img/favicon.png" /><meta name="twitter:title" content="decline: Refined Argument types" /><meta name="twitter:image" content="http://monovore.com/declineimg/poster.png" /><meta name="twitter:description" content="Composable command-line parsing for Scala" /><meta name="twitter:card" content="summary_large_image" /><link rel="icon" type="image/png" sizes="16x16" href="/decline/img/favicon16x16.png" /><link rel="icon" type="image/png" sizes="24x24" href="/decline/img/favicon24x24.png" /><link rel="icon" type="image/png" sizes="32x32" href="/decline/img/favicon32x32.png" /><link rel="icon" type="image/png" sizes="48x48" href="/decline/img/favicon48x48.png" /><link rel="icon" type="image/png" sizes="57x57" href="/decline/img/favicon57x57.png" /><link rel="icon" type="image/png" sizes="60x60" href="/decline/img/favicon60x60.png" /><link rel="icon" type="image/png" sizes="64x64" href="/decline/img/favicon64x64.png" /><link rel="icon" type="image/png" sizes="70x70" href="/decline/img/favicon70x70.png" /><link rel="icon" type="image/png" sizes="72x72" href="/decline/img/favicon72x72.png" /><link rel="icon" type="image/png" sizes="76x76" href="/decline/img/favicon76x76.png" /><link rel="icon" type="image/png" sizes="96x96" href="/decline/img/favicon96x96.png" /><link rel="icon" type="image/png" sizes="114x114" href="/decline/img/favicon114x114.png" /><link rel="icon" type="image/png" sizes="120x120" href="/decline/img/favicon120x120.png" /><link rel="icon" type="image/png" sizes="128x128" href="/decline/img/favicon128x128.png" /><link rel="icon" type="image/png" sizes="144x144" href="/decline/img/favicon144x144.png" /><link rel="icon" type="image/png" sizes="150x150" href="/decline/img/favicon150x150.png" /><link rel="icon" type="image/png" sizes="152x152" href="/decline/img/favicon152x152.png" /><link rel="icon" type="image/png" sizes="196x196" href="/decline/img/favicon196x196.png" /><link rel="icon" type="image/png" sizes="310x310" href="/decline/img/favicon310x310.png" /><link rel="icon" type="image/png" sizes="310x150" href="/decline/img/favicon310x150.png" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/decline/highlight/styles/solarized-light.css" /><link rel="stylesheet" href="/decline/css/style.css" /><link rel="stylesheet" href="/decline/css/palette.css" /><link rel="stylesheet" href="/decline/css/codemirror.css" /></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><ul id="sidebar" class="sidebar-nav"><li class="sidebar-brand"><a href="/decline/" class="brand"><div class="brand-wrapper"><span>decline</span></div></a></li><li><a href="/decline/arguments.html" class="">Arguments</a></li><li><a href="/decline/" class="">Home</a></li><li><a href="/decline/css/palette.css" class=""></a></li><li><a href="/decline/refined.html" class=" active ">Refined Argument types</a></li><li><a href="/decline/scalajs.html" class="">Scala.js</a></li><li><a href="/decline/css/style.css" class=""></a></li><li><a href="/decline/usage.html" class="">Using Decline</a></li></ul></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li id="gh-eyes-item" class="hidden-xs"><a href="https://github.com/bkirwi/decline"><i class="fa fa-eye"></i><span>WATCH<span id="eyes" class="label label-default">--</span></span></a></li><li id="gh-stars-item" class="hidden-xs"><a href="https://github.com/bkirwi/decline"><i class="fa fa-star-o"></i><span>STARS<span id="stars" class="label label-default">--</span></span></a></li><li><a href="#" onclick="shareSiteTwitter('decline Composable command-line parsing for Scala');"><i class="fa fa-twitter"></i></a></li><li><a href="#" onclick="shareSiteFacebook('decline Composable command-line parsing for Scala');"><i class="fa fa-facebook"></i></a></li><li><a href="#" onclick="shareSiteGoogle();"><i class="fa fa-google-plus"></i></a></li></ul></div></div></div></div><div id="content" data-github-owner="bkirwi" data-github-repo="decline"><div class="content-wrapper"><section><h1 id="refined-argument-types">Refined Argument Types</h1>

<p>Decline has support for <a href="https://github.com/fthomas/refined">refined types</a> via the <code class="highlighter-rouge">decline-refined</code> module.
Refined types add an extra layer of safety by decorating standard types with predicates that get validated
automatically at compile time.</p>

<p>Whilst in the case of command line arguments such validation can not happen at compile time since the values are
not know at the moment of building the code, runtime validation can still be done right before any value of
the command arguments is passed into the application logic, preventing the introduction of invalid values by the user.</p>

<h2 id="defining-refined-type-arguments">Defining Refined Type Arguments</h2>

<p>To make use of the refined types add the following to your <code class="highlighter-rouge">build.sbt</code>:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">libraryDependencies</span> <span class="o">+=</span> <span class="s">"com.monovore"</span> <span class="o">%%</span> <span class="s">"decline-refined"</span> <span class="o">%</span> <span class="s">"0.4.0"</span>
</code></pre>
</div>

<p>And now we need to add a series of imports into our current scope:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">import</span> <span class="nn">com.monovore.decline._</span>
<span class="k">import</span> <span class="nn">com.monovore.decline.refined._</span>
<span class="k">import</span> <span class="nn">eu.timepit.refined.api.Refined</span>
<span class="k">import</span> <span class="nn">eu.timepit.refined.auto._</span>
<span class="k">import</span> <span class="nn">eu.timepit.refined.numeric.Positive</span>
</code></pre>
</div>

<p>Following there is a very simple example of a numeric option which needs to be positive. We start by defining
a new type that can only hold positive integers:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">type</span> <span class="kt">PosInt</span> <span class="o">=</span> <span class="nc">Int</span> <span class="nc">Refined</span> <span class="nc">Positive</span>
<span class="c1">// defined type alias PosInt
</span></code></pre>
</div>

<p>And now we define an option parameterised on that specific type and a command so we can test it:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">val</span> <span class="n">lines</span> <span class="k">=</span> <span class="nc">Opts</span><span class="o">.</span><span class="n">option</span><span class="o">[</span><span class="kt">PosInt</span><span class="o">](</span><span class="s">"lines"</span><span class="o">,</span> <span class="n">short</span> <span class="k">=</span> <span class="s">"n"</span><span class="o">,</span> <span class="n">metavar</span> <span class="k">=</span> <span class="s">"count"</span><span class="o">,</span> <span class="n">help</span> <span class="k">=</span> <span class="s">"Set a number of lines."</span><span class="o">)</span>
<span class="c1">// lines: com.monovore.decline.Opts[PosInt] = Opts(--lines &lt;count&gt;)
</span>
<span class="k">val</span> <span class="n">cmd</span> <span class="k">=</span> <span class="nc">Command</span><span class="o">(</span><span class="s">"echoLines"</span><span class="o">,</span> <span class="s">"Echoes the number of lines"</span><span class="o">)(</span><span class="n">lines</span><span class="o">)</span>
<span class="c1">// cmd: com.monovore.decline.Command[PosInt] = com.monovore.decline.Command@5315175d
</span></code></pre>
</div>

<p>If we now try to parse a command line in which we have a <code class="highlighter-rouge">--lines 10</code> argument pair we should be able to parse
the <code class="highlighter-rouge">lines</code> option:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">cmd</span><span class="o">.</span><span class="n">parse</span><span class="o">(</span><span class="nc">Seq</span><span class="o">(</span><span class="s">"--lines"</span><span class="o">,</span> <span class="s">"10"</span><span class="o">))</span>
<span class="c1">// res0: Either[com.monovore.decline.Help,PosInt] = Right(10)
</span></code></pre>
</div>

<p>However if we pass a 0 or a non positive value, the <code class="highlighter-rouge">parse</code> operation should fail:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">cmd</span><span class="o">.</span><span class="n">parse</span><span class="o">(</span><span class="nc">Seq</span><span class="o">(</span><span class="s">"--lines"</span><span class="o">,</span> <span class="s">"0"</span><span class="o">))</span>
<span class="c1">// res1: Either[com.monovore.decline.Help,PosInt] =
// Left(Predicate failed: (0 &gt; 0).
// 
// Usage: echoLines --lines &lt;count&gt;
// 
// Echoes the number of lines
// 
// Options and flags:
//     --help
//         Display this help text.
//     --lines &lt;count&gt;, -n &lt;count&gt;
//         Set a number of lines.)
</span></code></pre>
</div>

<p>Check the documentation for <a href="https://github.com/fthomas/refined">refined</a> to see how you can define your own
refined types.</p>
</section></div></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/decline/highlight/highlight.pack.js"></script><script>hljs.configure({
languages:['scala','java','bash']
});
hljs.initHighlighting();
             </script><script>((window.gitter = {}).chat = {}).options = {
room: 'bkirwi/decline'};</script><script src="https://sidecar.gitter.im/dist/sidecar.v1.js"></script><script src="/decline/js/main.js"></script></body></html>